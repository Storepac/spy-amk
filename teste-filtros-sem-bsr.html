<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Filtros Sem BSR - AMK Spy</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            margin: 20px;
            background: #f8fafc;
            color: #374151;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #014641;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .filtros {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #014641;
        }
        
        .filter-group {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid #e5e7eb;
        }
        
        .filter-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #014641;
            font-size: 13px;
        }
        
        .filter-row {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        
        input[type="number"] {
            padding: 8px;
            border: 1px solid #ced4da;
            border-radius: 4px;
            font-size: 12px;
            width: 100px;
        }
        
        button {
            padding: 12px 20px;
            background: linear-gradient(135deg, #014641, #013935);
            color: white;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        button:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .resultado {
            background: #f0f9ff;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #0ea5e9;
        }
        
        .produto {
            background: white;
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            border: 1px solid #e5e7eb;
        }
        
        .produto.aprovado {
            border-left: 4px solid #10b981;
        }
        
        .produto.reprovado {
            border-left: 4px solid #ef4444;
            opacity: 0.7;
        }
        
        .sucesso {
            background: #f0fdf4;
            border: 1px solid #16a34a;
            color: #166534;
        }
        
        .info {
            background: #e0f2fe;
            border: 1px solid #0ea5e9;
            color: #0369a1;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚úÖ Filtros Funcionais (Sem BSR)</h1>
        
        <div class="info">
            <h3>üéØ Filtros Removidos</h3>
            <p>‚ùå <strong>Filtros BSR removidos</strong> - Causavam problemas de "nenhum item encontrado"</p>
            <p>‚úÖ <strong>Mantidos apenas</strong> - Filtros de Pre√ßo e Vendas que funcionam corretamente</p>
        </div>

        <div class="filtros">
            <h3>Filtros Dispon√≠veis</h3>
            
            <div class="filter-group">
                <label>üí∞ Pre√ßo do BuyBox</label>
                <div class="filter-row">
                    <input type="number" id="preco-min" placeholder="R$ M√≠n" step="0.01">
                    <span>at√©</span>
                    <input type="number" id="preco-max" placeholder="R$ M√°x" step="0.01">
                </div>
            </div>
            
            <div class="filter-group">
                <label>üìà N¬∞ de Vendas</label>
                <div class="filter-row">
                    <input type="number" id="vendas-min" placeholder="Vendas M√≠n" min="0">
                    <span>at√©</span>
                    <input type="number" id="vendas-max" placeholder="Vendas M√°x" min="0">
                </div>
            </div>
        </div>
        
        <button onclick="testarFiltros()">üöÄ Testar Filtros</button>

        <div id="resultado" class="resultado" style="display: none;">
            <h3>üìä Resultado do Teste</h3>
            <div id="resultado-content"></div>
        </div>
    </div>

    <script>
        // Produtos de teste
        const produtosTeste = [
            { titulo: "iPhone 15 Pro Max", precoNumerico: 8999.99, vendidos: 2500 },
            { titulo: "Samsung Galaxy S24", precoNumerico: 4999.99, vendidos: 1800 },
            { titulo: "Notebook Dell", precoNumerico: 2999.99, vendidos: 900 },
            { titulo: "Mouse Logitech", precoNumerico: 349.99, vendidos: 4200 },
            { titulo: "Teclado Mec√¢nico", precoNumerico: 599.99, vendidos: 650 },
            { titulo: "Monitor LG 27''", precoNumerico: 1299.99, vendidos: 1200 },
            { titulo: "Headset Gamer", precoNumerico: 399.99, vendidos: 2800 },
            { titulo: "Webcam Logitech", precoNumerico: 299.99, vendidos: 1500 },
            { titulo: "SSD Samsung 1TB", precoNumerico: 499.99, vendidos: 800 },
            { titulo: "Carregador Sem Fio", precoNumerico: 199.99, vendidos: 950 }
        ];

        // Simular l√≥gica simplificada (sem BSR)
        function coletarFiltros() {
            return {
                precoMin: parseFloat(document.getElementById('preco-min').value) || null,
                precoMax: parseFloat(document.getElementById('preco-max').value) || null,
                vendasMin: parseInt(document.getElementById('vendas-min').value) || null,
                vendasMax: parseInt(document.getElementById('vendas-max').value) || null
            };
        }

        function temFiltrosAtivos(filtros) {
            if (!filtros) return false;
            
            return filtros.precoMin || filtros.precoMax ||
                   filtros.vendasMin || filtros.vendasMax;
        }

        function aplicarFiltros(produtos, filtros) {
            if (!produtos || produtos.length === 0) return produtos;
            if (!temFiltrosAtivos(filtros)) return produtos;

            console.log('üéØ Aplicando filtros (sem BSR):', filtros);

            return produtos.filter((produto, index) => {
                // Extrair pre√ßo
                let preco = 0;
                if (produto.precoNumerico && !isNaN(parseFloat(produto.precoNumerico))) {
                    preco = parseFloat(produto.precoNumerico);
                }

                // Extrair vendas
                let vendas = 0;
                if (produto.vendidos && !isNaN(parseInt(produto.vendidos))) {
                    vendas = parseInt(produto.vendidos);
                }

                // Aplicar filtro pre√ßo
                if (filtros.precoMin || filtros.precoMax) {
                    if (filtros.precoMin && (preco === 0 || preco < filtros.precoMin)) {
                        return false;
                    }
                    if (filtros.precoMax && (preco === 0 || preco > filtros.precoMax)) {
                        return false;
                    }
                }

                // Aplicar filtro vendas
                if (filtros.vendasMin || filtros.vendasMax) {
                    if (filtros.vendasMin && vendas < filtros.vendasMin) {
                        return false;
                    }
                    if (filtros.vendasMax && vendas > filtros.vendasMax) {
                        return false;
                    }
                }

                return true;
            });
        }

        function testarFiltros() {
            const filtros = coletarFiltros();
            console.log('üéØ Filtros coletados:', filtros);

            const produtosFiltrados = aplicarFiltros(produtosTeste, filtros);
            
            const aprovados = produtosFiltrados.length;
            const reprovados = produtosTeste.length - aprovados;

            let html = `
                <div class="sucesso" style="padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <h4>‚úÖ Filtros funcionando corretamente!</h4>
                    <p><strong>Total:</strong> ${produtosTeste.length} produtos</p>
                    <p><strong>Aprovados:</strong> ${aprovados}</p>
                    <p><strong>Filtrados:</strong> ${reprovados}</p>
                    <p><strong>Status:</strong> ${temFiltrosAtivos(filtros) ? 'Filtros ativos' : 'Sem filtros'}</p>
                </div>
            `;

            if (temFiltrosAtivos(filtros)) {
                html += `
                    <div style="background: #e0f2fe; padding: 10px; border-radius: 6px; margin-bottom: 15px; font-size: 12px;">
                        <strong>Filtros aplicados:</strong>
                        ${filtros.precoMin ? `Pre√ßo ‚â• R$ ${filtros.precoMin} ` : ''}
                        ${filtros.precoMax ? `Pre√ßo ‚â§ R$ ${filtros.precoMax} ` : ''}
                        ${filtros.vendasMin ? `Vendas ‚â• ${filtros.vendasMin} ` : ''}
                        ${filtros.vendasMax ? `Vendas ‚â§ ${filtros.vendasMax}` : ''}
                    </div>
                `;
            }

            html += `<h4>üìã Produtos processados:</h4>`;

            // Mostrar produtos aprovados
            produtosFiltrados.forEach(produto => {
                html += `
                    <div class="produto aprovado">
                        <strong>‚úÖ ${produto.titulo}</strong><br>
                        Pre√ßo: R$ ${produto.precoNumerico} | Vendas: ${produto.vendidos}
                    </div>
                `;
            });

            // Mostrar produtos reprovados
            const produtosReprovados = produtosTeste.filter(p => !produtosFiltrados.includes(p));
            produtosReprovados.forEach(produto => {
                html += `
                    <div class="produto reprovado">
                        <strong>‚ùå ${produto.titulo}</strong><br>
                        Pre√ßo: R$ ${produto.precoNumerico} | Vendas: ${produto.vendidos}
                    </div>
                `;
            });

            document.getElementById('resultado').style.display = 'block';
            document.getElementById('resultado-content').innerHTML = html;

            console.log(`‚úÖ Teste conclu√≠do: ${aprovados}/${produtosTeste.length} produtos aprovados`);
        }

        // Teste autom√°tico ao carregar
        window.onload = function() {
            console.log('üéØ Testando filtros sem BSR...');
            
            // Configurar filtros para teste
            document.getElementById('preco-min').value = '500';
            document.getElementById('preco-max').value = '2000';
            document.getElementById('vendas-min').value = '1000';
            
            setTimeout(testarFiltros, 500);
        };
    </script>
</body>
</html> 